"use strict";(self.webpackChunk_4dev=self.webpackChunk_4dev||[]).push([[798],{798:function(e,t,n){n.r(t),n.d(t,{default:function(){return K}});var r,s,i=n(9439),l="Tasks_header__C1Mpl",a="Tasks_wrapper__sPWtI",o="Tasks_groups__Q3Fon",u="Tasks_group__f59D8",c="Tasks_group__title__WFep5",d="Tasks_description__AKl1w",f="Tasks_buttons__FDuE4",h="Tasks_form__UgiPg",x=n(7689),j=n(5355),_=n(2791),p=n(7421),m=function(e){return e.tasks},v=n(4942),E=function(e){return e[e.IN_QUEUE=0]="IN_QUEUE",e[e.IN_PROGRESS=1]="IN_PROGRESS",e[e.DONE=2]="DONE",e}({}),N=function(e){return e[e.FIRST=0]="FIRST",e[e.SECOND=1]="SECOND",e[e.THIRD=2]="THIRD",e}({}),Z=(r={},(0,v.Z)(r,E.IN_QUEUE,"\u0412 \u043e\u0447\u0435\u0440\u0435\u0434\u0438"),(0,v.Z)(r,E.IN_PROGRESS,"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435"),(0,v.Z)(r,E.DONE,"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e"),r),T=(s={},(0,v.Z)(s,N.FIRST,"\u0421\u0440\u043e\u0447\u043d\u043e"),(0,v.Z)(s,N.SECOND,"\u0412\u0430\u0436\u043d\u043e"),(0,v.Z)(s,N.THIRD,"\u041d\u0435 \u0441\u0440\u043e\u0447\u043d\u043e"),s),k=n(7309),S=n(9904),C=n(4949),g=n(184),y=function(){var e=(0,j.aC)(),t=e.user,n=e.signOut,r=(0,C.dd)().setContentType;return(0,g.jsxs)("div",{className:l,children:[(0,g.jsx)(k.ZP,{onClick:function(){r("CREATE")},children:"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430"}),(0,g.jsxs)("div",{children:[(0,g.jsx)(k.ZP,{type:"link",onClick:n,children:"\u0412\u044b\u0439\u0442\u0438"}),(0,g.jsx)(S.C,{children:t})]})]})},I=n(358),R="TaskCardTitle_container__2TMQA",O="TaskCardTitle_indicator__ybPDO",D="TaskCardTitle_first__ST5Js",U="TaskCardTitle_second__UABCV",P="TaskCardTitle_third__70Jp0",b=n(1694),Q=n.n(b),A=function(e){var t,n=e.title,r=e.priority;return(0,g.jsxs)("div",{className:R,children:[(0,g.jsx)("div",{className:Q()(O,(t={},(0,v.Z)(t,D,r===N.FIRST),(0,v.Z)(t,U,r===N.SECOND),(0,v.Z)(t,P,r===N.THIRD),t))}),(0,g.jsx)("div",{children:n})]})},F=function(e){var t=e.task,n=t.title,r=t.author_name,s=t.priority,i=(0,p.ol)().setCurrentTask,l=(0,C.dd)().setContentType;return(0,g.jsxs)(I.Z,{hoverable:!0,bordered:!1,onClick:function(){l("UPDATE"),i(t)},children:[(0,g.jsx)(A,{title:n,priority:s}),(0,g.jsx)("hr",{}),(0,g.jsx)("div",{children:r})]})},G=function(e){e.children;var t=e.title,n=e.tasks;return(0,g.jsxs)(I.Z,{children:[(0,g.jsx)("div",{className:c,children:t}),(0,g.jsx)("div",{className:u,children:n.sort((function(e,t){return e.priority-t.priority})).map((function(e){return(0,g.jsx)(F,{task:e},e.id)}))})]})},q=n(1413),w=n(8488),H=n(208),V=n(1134),J=function(e){return Object.entries(e).map((function(e){var t=(0,i.Z)(e,2);return{value:t[0],label:t[1]}}))},M=function(e){var t=e.task,n=t.id,r=t.title,s=t.author_name,l=t.description,a=t.status,o=t.priority,u=(0,p.ol)(),c=u.deleteTask,x=u.updateTask,j=u.setCurrentTask,m=(0,V.cI)(),v=m.control,E=m.handleSubmit,N=m.watch,S=(0,C.dd)(),y=S.onClose,I=S.contentType,R=(0,_.useState)([]),O=(0,i.Z)(R,2),D=O[0],U=O[1],P=(0,_.useState)([]),b=(0,i.Z)(P,2),Q=b[0],A=b[1],F=(0,_.useState)(!0),G=(0,i.Z)(F,2),M=G[0],W=G[1],z=(0,_.useCallback)((function(e){var t={id:n};"undefined"!==typeof e.status&&(t.status=+e.status),"undefined"!==typeof e.priority&&(t.priority=+e.priority),console.log(e),x(t),y(),j(null)}),[n,y,j,x]);return(0,_.useEffect)((function(){U(J(Z)),A(J(T))}),[]),(0,_.useEffect)((function(){N((function(e){W(!(a!==+e.status||o!==+e.priority))}))}),[o,a,N]),(0,g.jsx)(w.Z,{title:r,open:"UPDATE"===I,onCancel:y,footer:null,destroyOnClose:!0,children:(0,g.jsxs)("form",{onSubmit:E(z),className:h,children:[(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u0418\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c:"}),(0,g.jsx)("i",{children:s})]}),(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438:"}),(0,g.jsx)("i",{children:l})]}),(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:"}),(0,g.jsx)(V.Qr,{render:function(e){var t=e.field;return(0,g.jsx)(H.Z,(0,q.Z)((0,q.Z)({},t),{},{options:D,defaultValue:a.toString()}))},name:"status",control:v},D.length)]}),(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442:"}),(0,g.jsx)(V.Qr,{render:function(e){var t=e.field;return(0,g.jsx)(H.Z,(0,q.Z)((0,q.Z)({},t),{},{options:Q,defaultValue:o.toString()}))},name:"priority",control:v},Q.length)]}),(0,g.jsxs)("div",{className:f,children:[(0,g.jsx)(k.ZP,{danger:!0,onClick:function(){c(n),y(),j(null)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),(0,g.jsx)(k.ZP,{disabled:M,htmlType:"submit",type:"primary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})},W=n(2298),z=W.Z.TextArea,B=function(){var e=(0,p.ix)(m).authors,t=(0,p.ol)().createTask,n=(0,V.cI)(),r=n.control,s=n.handleSubmit,l=n.reset,a=(0,C.dd)(),o=a.onClose,u=a.contentType,c=(0,_.useState)([]),x=(0,i.Z)(c,2),j=x[0],v=x[1],E=(0,_.useState)([]),N=(0,i.Z)(E,2),S=N[0],y=N[1],I=(0,_.useState)([]),R=(0,i.Z)(I,2),O=R[0],D=R[1],U=function(){o(),l()},P=function(t){var n=e.find((function(e){return e.id===t}));return n?n.author_name:""},b=(0,_.useCallback)((function(e){var n=(0,q.Z)((0,q.Z)({},e),{},{priority:+e.priority,status:+e.status,author_name:P(e.author_name)});t(n),U()}),[t,P,U]);return(0,_.useEffect)((function(){v(J(Z)),y(J(T))}),[]),(0,_.useEffect)((function(){e.length&&D(e.map((function(e){return{value:e.id,label:e.author_name}})))}),[e]),(0,g.jsx)(w.Z,{title:"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430",open:"CREATE"===u,onCancel:U,footer:null,destroyOnClose:!0,children:(0,g.jsxs)("form",{onSubmit:s(b),className:h,children:[(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:"}),(0,g.jsx)(V.Qr,{render:function(e){var t=e.field;return(0,g.jsx)(W.Z,(0,q.Z)({},t))},name:"title",control:r,rules:{required:!0}},O.length)]}),(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u0418\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c:"}),(0,g.jsx)(V.Qr,{render:function(e){var t=e.field;return(0,g.jsx)(H.Z,(0,q.Z)((0,q.Z)({},t),{},{options:O}))},name:"author_name",control:r,rules:{required:!0}},O.length)]}),(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438:"}),(0,g.jsx)(V.Qr,{render:function(e){var t=e.field;return(0,g.jsx)(z,(0,q.Z)({},t))},name:"description",control:r,rules:{required:!0}},O.length)]}),(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:"}),(0,g.jsx)(V.Qr,{render:function(e){var t=e.field;return(0,g.jsx)(H.Z,(0,q.Z)((0,q.Z)({},t),{},{options:j}))},name:"status",control:r,rules:{required:!0}},j.length)]}),(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("strong",{children:"\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442:"}),(0,g.jsx)(V.Qr,{render:function(e){var t=e.field;return(0,g.jsx)(H.Z,(0,q.Z)((0,q.Z)({},t),{},{options:S}))},name:"priority",control:r,rules:{required:!0}},S.length)]}),(0,g.jsxs)("div",{className:f,children:[(0,g.jsx)(k.ZP,{onClick:U,children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),(0,g.jsx)(k.ZP,{htmlType:"submit",type:"primary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})},K=function(){var e,t,n,r=(0,p.ix)(m),s=r.tasks,l=r.currentTask,u=(0,j.aC)().authorized,c=(0,x.TH)(),d=(0,p.ol)(),f=d.fetchTasks,h=d.fetchAuthors,v=(0,_.useState)({}),N=(0,i.Z)(v,2),T=N[0],k=N[1];return(0,_.useEffect)((function(){u&&(f(),h())}),[u,h,f]),(0,_.useEffect)((function(){if(s.length){var e={};e[E.IN_QUEUE]=s.filter((function(e){return e.status===E.IN_QUEUE})),e[E.IN_PROGRESS]=s.filter((function(e){return e.status===E.IN_PROGRESS})),e[E.DONE]=s.filter((function(e){return e.status===E.DONE})),k(e)}}),[s]),u?(0,g.jsxs)("div",{className:a,children:[(0,g.jsx)(y,{}),(0,g.jsx)(B,{}),l&&(0,g.jsx)(M,{task:l}),(0,g.jsxs)("div",{className:o,children:[!(null===(e=T[E.IN_QUEUE])||void 0===e||!e.length)&&(0,g.jsx)(G,{tasks:T[E.IN_QUEUE],title:Z[E.IN_QUEUE]}),!(null===(t=T[E.IN_PROGRESS])||void 0===t||!t.length)&&(0,g.jsx)(G,{tasks:T[E.IN_PROGRESS],title:Z[E.IN_PROGRESS]}),!(null===(n=T[E.DONE])||void 0===n||!n.length)&&(0,g.jsx)(G,{tasks:T[E.DONE],title:Z[E.DONE]})]})]}):(0,g.jsx)(x.Fg,{to:"/error",state:{from:c},replace:!0})}}}]);
//# sourceMappingURL=798.3f99a1e7.chunk.js.map